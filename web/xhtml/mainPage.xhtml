<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <ui:composition template="/templates/layout.xhtml">
        <ui:define name="top">
            #{bundle.Message}
        </ui:define>
        <ui:define id="mainContent" name="content">
            <f:event type="preRenderView" listener="#{memberFilterData.setPersonStat(true)}"/>
            <!--p:growl id="message" showDetail="true" /-->
            <h:outputScript library="js" name="myJs.js" target="body"/>
            <h:form id="mainForm">


                <h:panelGrid columns="2">
                    <p:outputLabel value="OU Code: "/>
                    <p:selectOneMenu value="#{memberFilterData.ouCodeID}" 
                                     filterMatchMode="startsWith" 
                                     filter="true">
                        <f:selectItem noSelectionOption="true" itemLabel="Select OU Code" itemValue=""/>
                        <f:selectItems value="#{returnObject.ouList()}" 
                                       var="ou" 
                                       itemLabel="#{ou.ouShortName}"
                                       itemValue="#{ou.ouCode}"/>
                    </p:selectOneMenu>

                    <p:outputLabel value="Status: "/>
                    <p:selectOneMenu value="#{memberFilterData.status}">
                        <f:selectItem noSelectionOption="true" itemLabel="Select Status"/>
                        <f:selectItems value="#{returnObject.memStatList()}" 
                                       var="stat" 
                                       itemLabel="#{stat.statusName}"
                                       itemValue="#{stat.memStatus}"/>
                    </p:selectOneMenu>

                    <p:outputLabel value="Membership date: "/>
                    <p:outputLabel value="&nbsp;"/>

                    <p:calendar id="dateFrom" 
                                value="#{memberFilterData.membershipDateFrom}" 
                                maxdate="#{currentDate}" 
                                pattern="MMM dd yyyy"
                                placeholder="From"
                                onclick="this.select()"
                                navigator="true">
                        <p:ajax event="dateSelect" update=":#{p:component('dateTo')}" listener="#{memberFilterData.setMembershipDateTo(null)}"/>
                        <p:ajax event="keyup" update=":#{p:component('dateTo')}" listener="#{memberFilterData.setMembershipDateTo(null)}"/>
                    </p:calendar>

                    <p:calendar id="dateTo" 
                                value="#{memberFilterData.membershipDateTo}" 
                                maxdate="#{currentDate}" 
                                mindate="#{memberFilterData.membershipDateFrom}" 
                                pattern="MMM dd yyyy"
                                placeholder="To"
                                onclick="this.select()"
                                navigator="true"
                                disabled="#{empty memberFilterData.membershipDateFrom}">
                        <p:ajax event="dateSelect" update=":#{p:component('dateFrom')}"/>
                        <p:ajax event="keyup" update=":#{p:component('dateFrom')}"/>
                    </p:calendar>

                    <p:outputLabel value="Occupation: "/>
                    <p:selectOneMenu value="#{memberFilterData.occupation}"
                                     filterMatchMode="startsWith" 
                                     filter="true">
                        <f:selectItem noSelectionOption="true" itemLabel="Select Status"/>
                        <f:selectItems value="#{returnObject.memOccupationList()}" 
                                       var="occption" 
                                       itemLabel="#{occption}"
                                       itemValue="#{occption}"/>
                    </p:selectOneMenu>

                    <p:outputLabel value="Compensation: Php "/>
                    <p:selectOneMenu value="#{memberFilterData.compensation}">
                        <f:selectItem noSelectionOption="true" itemLabel="Select Bracket" itemValue=""/>
                        <f:selectItem itemLabel="999.00 - Below" itemValue="999.00 - Below"/>
                        <f:selectItem itemLabel="1,000.00 - 10,000.00" itemValue="1,000.00 - 10,000.00"/>
                        <f:selectItem itemLabel="10,001.00 - 12,000.00" itemValue="10,001.00 - 12,000.00"/>
                        <f:selectItem itemLabel="15,001.00 - 20,000.00" itemValue="15,001.00 - 20,000.00"/>
                        <f:selectItem itemLabel="20,001.00 - 30,000.00" itemValue="20,001.00 - 30,000.00"/>
                        <f:selectItem itemLabel="30,001.00 - 40,000.00" itemValue="30,001.00 - 40,000.00"/>
                        <f:selectItem itemLabel="40,001.00 - 50,000.00" itemValue="40,001.00 - 50,000.00"/>
                        <f:selectItem itemLabel="50,001.00 - Above" itemValue="50,001.00 - Above"/>
                    </p:selectOneMenu>

                    <p:outputLabel value="Age Bracket: "/>
                    <p:outputLabel value="&nbsp;"/>

                    <p:inputText id="ageFrom" value="#{memberFilterData.ageFrom}" 
                                 placeholder="From"
                                 onclick="this.select()"
                                 onkeypress="return isNumberKey(event.keyCode)" 
                                 type="number">
                        <p:ajax event="keyup" 
                                update=":#{p:component('ageTo')}"
                                listener="#{memberFilterData.setAgeTo(null)}"/>
                    </p:inputText>
                    <p:inputText id="ageTo" value="#{memberFilterData.ageTo}" 
                                 placeholder="To" 
                                 onclick="this.select()"
                                 onkeypress="return isNumberKey(event.keyCode)" 
                                 type="number"
                                 disabled="#{empty memberFilterData.ageFrom}">
                    </p:inputText>

                    <p:outputLabel value="Person Status: "/>
                    <p:selectBooleanButton value="#{memberFilterData.personStat}" offLabel="Deceased" onLabel="Alive"/>
                </h:panelGrid>
                <br/>

                <p:commandButton value="Generate" 
                                 icon="ui-icon-document"
                                 styleClass="ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-document"
                                 update=":#{p:component('memberList')}, :#{p:component('associateList')}"
                                 action="#{associateListModel.setAssociateList(generateData.associateList(memberFilterData))}"
                                 actionListener="#{memberListModel.setMemberList(generateData.memberList(memberFilterData))}">
                </p:commandButton>
                <br/><br/>
                <p:tabView>
                    <p:tab title="Regular Member">
                        <p>
                            <div style="overflow: auto; height: 350px">
                                <p:dataTable id="memberList"
                                             value="#{memberListModel.memberList}" 
                                             var="member">
                                    <p:column style="width: 20px">
                                        <p:commandLink update=":#{p:component('memberDetail')}" 
                                                       oncomplete="PF('memberDialog').show()" 
                                                       title="View Detail" 
                                                       styleClass="ui-icon ui-icon-search" 
                                                       style="float:left;margin-right:10px">
                                            <f:setPropertyActionListener value="#{member}" 
                                                                         target="#{memberListModel.selectedMember}" />
                                            <h:outputText value="#{member.scAcctno} - #{member.PPrefix} #{member.lastName}, #{member.firstName} #{member.middleName}. #{member.suffix}"/>
                                        </p:commandLink>
                                    </p:column>
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Regular members" />
                                        </f:facet>
                                        <h:outputText value="#{member.memIdNo} - #{member.PPrefix} #{member.lastName}, #{member.firstName} #{member.middleName}. #{member.suffix}" 
                                                      style="display:inline-block"/>
                                    </p:column>
                                </p:dataTable>
                            </div>
                        </p>
                        <br/>
                        <p>
                            <span>
                                <p:commandButton value="Print"
                                                 icon="ui-icon-print"
                                                 styleClass="ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-print">
                                    <p:printer target="memberList"/>
                                </p:commandButton>
                                <p:commandButton value="Export" actionListener="#{exportData.memberList(memberListModel.memberList)}"
                                                 icon="ui-icon-document"
                                                 styleClass="ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-document">
                                </p:commandButton>
                            </span>
                        </p>

                        <p:dialog header="Basic Member Info" widgetVar="memberDialog" modal="true" 
                                  showEffect="fade" 
                                  hideEffect="fade" 
                                  resizable="false">
                            <p:outputPanel id="memberDetail" style="text-align:center;">
                                <p:panelGrid  columns="2" rendered="#{not empty memberListModel.selectedMember}" columnClasses="label,value">
                                    <h:outputText value="Account No.:" />
                                    <h:outputText value="#{memberListModel.selectedMember.scAcctno}" />

                                    <h:outputText value="Name" />
                                    <h:outputText value="#{memberListModel.selectedMember.PPrefix} #{memberListModel.selectedMember.lastName}, #{memberListModel.selectedMember.firstName} #{memberListModel.selectedMember.middleName}. #{memberListModel.selectedMember.suffix}"/>

                                    <h:outputText value="Birthdate:" />
                                    <h:outputText value="#{dateFormat.formatDate(memberListModel.selectedMember.birthdate, 'MMM dd yyyy')}" />
                                </p:panelGrid>
                            </p:outputPanel>
                        </p:dialog>
                    </p:tab>
                    <p:tab title="Associate Member">
                        <p>
                            <div style="overflow: auto; height: 350px">
                                <p:dataTable id="associateList"
                                             value="#{associateListModel.associateList}" 
                                             var="associate">
                                    <p:column style="width: 20px">
                                        <p:commandLink update=":#{p:component('associateDetail')}" 
                                                       oncomplete="PF('associateDialog').show()" 
                                                       title="View Detail" 
                                                       styleClass="ui-icon ui-icon-search" 
                                                       style="float:left;margin-right:10px">
                                            <f:setPropertyActionListener value="#{associate}" 
                                                                         target="#{associateListModel.selectedAssociate}" />
                                            <h:outputText value="#{associate.scAcctno} - #{associate.PPrefix} #{associate.lastName}, #{associate.firstName} #{associate.middleName}. #{associate.suffix}"/>
                                        </p:commandLink>
                                    </p:column>
                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="Associate members" />
                                        </f:facet>
                                        <h:outputText value="#{associate.memIdNo} - #{associate.PPrefix} #{associate.lastName}, #{associate.firstName} #{associate.middleName}. #{associate.suffix}" 
                                                      style="display:inline-block"/>
                                    </p:column>
                                </p:dataTable>
                            </div>
                        </p>
                        <br/>
                        <p>
                            <span>
                                <p:commandButton value="Print"
                                                 icon="ui-icon-print"
                                                 styleClass="ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-print">
                                    <p:printer target="associateList"/>
                                </p:commandButton>
                                <p:commandButton value="Export" actionListener="#{exportData.associateList(associateListModel.associateList)}"
                                                 icon="ui-icon-document"
                                                 styleClass="ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-document">
                                </p:commandButton>
                            </span>
                        </p>

                        <p:dialog header="Basic Member Info" widgetVar="associateDialog" modal="true" 
                                  showEffect="fade" 
                                  hideEffect="fade" 
                                  resizable="false">
                            <p:outputPanel id="associateDetail" style="text-align:center;">
                                <p:panelGrid  columns="2" rendered="#{not empty associateListModel.selectedAssociate}" columnClasses="label,value">
                                    <h:outputText value="Account No.:" />
                                    <h:outputText value="#{associateListModel.selectedAssociate.scAcctno}" />

                                    <h:outputText value="Name" />
                                    <h:outputText value="#{associateListModel.selectedAssociate.PPrefix} #{associateListModel.selectedAssociate.lastName}, #{associateListModel.selectedAssociate.firstName} #{associateListModel.selectedAssociate.middleName}. #{associateListModel.selectedAssociate.suffix}"/>

                                    <h:outputText value="Birthdate:" />
                                    <h:outputText value="#{dateFormat.formatDate(associateListModel.selectedAssociate.birthdate, 'MMM dd yyyy')}" />
                                </p:panelGrid>
                            </p:outputPanel>
                        </p:dialog>
                    </p:tab>
                </p:tabView>
            </h:form>
        </ui:define>
    </ui:composition>
</html>
